<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¸ äº’å‹•å¼å‰ä»–å’Œå¼¦åº« - 30çµ„å¸¸ç”¨å’Œå¼¦</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e67e22;
            --success: #27ae60;
            --bg: #f8f9fa;
        }

        body {
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { color: var(--primary); margin-bottom: 10px; }

        /* è²éŸ³æ§åˆ¶å€ */
        .controls {
            margin-bottom: 25px;
            text-align: center;
        }

        #soundToggle {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            background-color: #ddd;
            color: #333;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        #soundToggle.active {
            background-color: var(--success);
            color: white;
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            display: flex;
            gap: 30px;
            max-width: 1100px;
            width: 100%;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* å·¦å´å’Œå¼¦æŒ‰éˆ•å€ */
        .chord-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            flex: 1;
            min-width: 350px;
        }

        .chord-btn {
            padding: 12px 5px;
            border: 1px solid #eee;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
            color: var(--primary);
        }

        .chord-btn:hover { background: #f0f0f0; border-color: var(--accent); }
        .chord-btn.active { background: var(--accent); color: white; border-color: var(--accent); }

        /* å³å´å±•ç¤ºå¡ç‰‡ */
        .display-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            text-align: center;
            width: 320px;
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        /* å‰ä»–æŒ‡æ¿ç¹ªè£½ */
        .fretboard {
            width: 200px;
            height: 240px;
            margin: 20px auto;
            position: relative;
            border: 2px solid #444;
            background: #fff;
        }

        .string { position: absolute; width: 2px; background: #bbb; height: 100%; z-index: 1; }
        .fret { position: absolute; height: 2px; background: #444; width: 100%; z-index: 2; }
        
        /* å¼¦çš„ä½ç½® (1-6å¼¦) */
        .s1 { left: 100%; } .s2 { left: 80%; } .s3 { left: 60%; }
        .s4 { left: 40%; } .s5 { left: 20%; } .s6 { left: 0%; }

        /* æ ¼çš„ä½ç½® (1-4æ ¼) */
        .f1 { top: 20%; } .f2 { top: 40%; } .f3 { top: 60%; } .f4 { top: 80%; }

        .finger {
            position: absolute;
            width: 22px;
            height: 22px;
            background: #e74c3c;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .info-text { margin-top: 20px; font-size: 1.1rem; color: #555; }
        .info-text b { color: var(--primary); }

        @media (max-width: 768px) {
            .chord-grid { grid-template-columns: repeat(4, 1fr); }
            .main-container { flex-direction: column-reverse; align-items: center; }
        }
    </style>
</head>
<body>

    <h1>ğŸ¸ äº’å‹•å¼å‰ä»–å’Œå¼¦åº«</h1>
    
    <div class="controls">
        <button id="soundToggle" onclick="toggleSound()">ğŸ”‡ è²éŸ³é–‹é—œï¼šå·²é—œé–‰</button>
        <p style="font-size: 0.9rem; color: #888; margin-top: 8px;">é–‹å•Ÿå¾Œé»é¸å’Œå¼¦å³å¯è‡ªå‹•ç™¼è²</p>
    </div>

    <div class="main-container">
        <div class="chord-grid" id="chordGrid"></div>

        <div class="display-card">
            <h2 id="currentName" style="margin: 0; font-size: 2rem; color: var(--accent);">è«‹é¸æ“‡å’Œå¼¦</h2>
            <div class="fretboard" id="fretboard">
                <div class="string s1"></div><div class="string s2"></div>
                <div class="string s3"></div><div class="string s4"></div>
                <div class="string s5"></div><div class="string s6"></div>
                <div class="fret f1"></div><div class="fret f2"></div>
                <div class="fret f3"></div><div class="fret f4"></div>
            </div>
            <div class="info-text">
                çµ„æˆéŸ³ï¼š<b id="chordNotes">-</b>
            </div>
        </div>
    </div>

    <script>
        // --- å®Œæ•´ 30 å€‹å’Œå¼¦è³‡æ–™åº« ---
        const chords = {
            "C": { fingers: [{s:5, f:3}, {s:4, f:2}, {s:2, f:1}], notes: "C, E, G", freq: ["C3", "E3", "G3", "C4", "E4"] },
            "G": { fingers: [{s:6, f:3}, {s:5, f:2}, {s:1, f:3}], notes: "G, B, D", freq: ["G2", "B2", "D3", "G3", "B3", "G4"] },
            "D": { fingers: [{s:3, f:2}, {s:2, f:3}, {s:1, f:2}], notes: "D, F#, A", freq: ["D3", "A3", "D4", "F#4"] },
            "A": { fingers: [{s:4, f:2}, {s:3, f:2}, {s:2, f:2}], notes: "A, C#, E", freq: ["A2", "E3", "A3", "C#4", "E4"] },
            "E": { fingers: [{s:5, f:2}, {s:4, f:2}, {s:3, f:1}], notes: "E, G#, B", freq: ["E2", "B2", "E3", "G#3", "B3", "E4"] },
            "Am": { fingers: [{s:4, f:2}, {s:3, f:2}, {s:2, f:1}], notes: "A, C, E", freq: ["A2", "E3", "A3", "C4", "E4"] },
            "Em": { fingers: [{s:5, f:2}, {s:4, f:2}], notes: "E, G, B", freq: ["E2", "B2", "E3", "G3", "B3", "E4"] },
            "Dm": { fingers: [{s:3, f:2}, {s:2, f:3}, {s:1, f:1}], notes: "D, F, A", freq: ["D3", "A3", "D4", "F4"] },
            "F": { fingers: [{s:6, f:1}, {s:5, f:3}, {s:4, f:3}, {s:3, f:2}, {s:2, f:1}, {s:1, f:1}], notes: "F, A, C", freq: ["F2", "C3", "F3", "A3", "C4", "F4"] },
            "Bm": { fingers: [{s:5, f:2}, {s:4, f:4}, {s:3, f:4}, {s:2, f:3}, {s:1, f:2}], notes: "B, D, F#", freq: ["B2", "F#3", "B3", "D4", "F#4"] },
            "C7": { fingers: [{s:5, f:3}, {s:4, f:2}, {s:3, f:3}, {s:2, f:1}], notes: "C, E, G, Bb", freq: ["C3", "E3", "Bb3", "C4", "E4"] },
            "G7": { fingers: [{s:6, f:3}, {s:5, f:2}, {s:1, f:1}], notes: "G, B, D, F", freq: ["G2", "B2", "D3", "G3", "B3", "F4"] },
            "D7": { fingers: [{s:3, f:2}, {s:2, f:1}, {s:1, f:2}], notes: "D, F#, A, C", freq: ["D3", "A3", "C4", "F#4"] },
            "A7": { fingers: [{s:4, f:2}, {s:2, f:2}], notes: "A, C#, E, G", freq: ["A2", "E3", "G3", "C#4", "E4"] },
            "E7": { fingers: [{s:5, f:2}, {s:3, f:1}], notes: "E, G#, B, D", freq: ["E2", "B2", "D3", "G#3", "B3", "E4"] },
            "Fmaj7": { fingers: [{s:4, f:3}, {s:3, f:2}, {s:2, f:1}], notes: "F, A, C, E", freq: ["F3", "A3", "C4", "E4"] },
            "Cadd9": { fingers: [{s:5, f:3}, {s:4, f:2}, {s:2, f:3}], notes: "C, E, G, D", freq: ["C3", "E3", "G3", "D4"] },
            "Asus4": { fingers: [{s:4, f:2}, {s:3, f:2}, {s:2, f:3}], notes: "A, D, E", freq: ["A2", "E3", "A3", "D4", "E4"] },
            "Dsus4": { fingers: [{s:3, f:2}, {s:2, f:3}, {s:1, f:3}], notes: "D, G, A", freq: ["D3", "A3", "D4", "G4"] },
            "B7": { fingers: [{s:5, f:2}, {s:4, f:1}, {s:3, f:2}, {s:1, f:2}], notes: "B, D#, F#, A", freq: ["B2", "D#3", "A3", "B3", "F#4"] },
            "Am7": { fingers: [{s:4, f:2}, {s:2, f:1}], notes: "A, C, E, G", freq: ["A2", "E3", "G3", "C4", "E4"] },
            "Em7": { fingers: [{s:5, f:2}, {s:4, f:2}, {s:2, f:3}], notes: "E, G, B, D", freq: ["E2", "B2", "D3", "G3", "D4", "E4"] },
            "Dm7": { fingers: [{s:3, f:2}, {s:2, f:1}, {s:1, f:1}], notes: "D, F, A, C", freq: ["D3", "A3", "C4", "F4"] },
            "Gmaj7": { fingers: [{s:6, f:3}, {s:1, f:2}], notes: "G, B, D, F#", freq: ["G2", "B2", "D3", "G3", "B3", "F#4"] },
            "Bb": { fingers: [{s:5, f:1}, {s:4, f:3}, {s:3, f:3}, {s:2, f:3}], notes: "Bb, D, F", freq: ["Bb2", "F3", "Bb3", "D4", "F4"] },
            "Gm": { fingers: [{s:6, f:3}, {s:5, f:5}, {s:4, f:5}, {s:3, f:3}, {s:2, f:3}, {s:1, f:3}], notes: "G, Bb, D", freq: ["G2", "D3", "G3", "Bb3", "D4", "G4"] },
            "F#m": { fingers: [{s:6, f:2}, {s:5, f:4}, {s:4, f:4}, {s:3, f:2}, {s:2, f:2}, {s:1, f:2}], notes: "F#, A, C#", freq: ["F#2", "C#3", "F#3", "A3", "C#4", "F#4"] },
            "Bm7": { fingers: [{s:5, f:2}, {s:3, f:2}, {s:2, f:3}], notes: "B, D, F#, A", freq: ["B2", "F#3", "A3", "D4", "F#4"] },
            "Emaj7": { fingers: [{s:5, f:2}, {s:4, f:1}, {s:3, f:1}], notes: "E, G#, B, D#", freq: ["E2", "B2", "D#3", "G#3", "B3", "E4"] },
            "G6": { fingers: [{s:6, f:3}, {s:5, f:2}], notes: "G, B, D, E", freq: ["G2", "B2", "D3", "G3", "B3", "E4"] }
        };

        const synth = new Tone.PolySynth(Tone.Synth).toDestination();
        let isSoundOn = false;
        let currentChordKey = null;

        // ç”Ÿæˆ 30 å€‹æŒ‰éˆ•
        const grid = document.getElementById('chordGrid');
        Object.keys(chords).forEach(name => {
            const btn = document.createElement('button');
            btn.className = 'chord-btn';
            btn.innerText = name;
            btn.onclick = () => selectChord(name, btn);
            grid.appendChild(btn);
        });

        // è²éŸ³é–‹é—œåˆ‡æ›
        function toggleSound() {
            isSoundOn = !isSoundOn;
            const btn = document.getElementById('soundToggle');
            if (isSoundOn) {
                btn.innerText = "ğŸ”Š è²éŸ³é–‹é—œï¼šå·²é–‹å•Ÿ";
                btn.classList.add('active');
                Tone.start();
            } else {
                btn.innerText = "ğŸ”‡ è²éŸ³é–‹é—œï¼šå·²é—œé–‰";
                btn.classList.remove('active');
            }
        }

        // é¸æ“‡å’Œå¼¦é‚è¼¯
        function selectChord(name, btnElement) {
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.chord-btn').forEach(b => b.classList.remove('active'));
            btnElement.classList.add('active');

            const chord = chords[name];
            currentChordKey = name;
            
            // æ›´æ–°æ–‡å­—
            document.getElementById('currentName').innerText = name;
            document.getElementById('chordNotes').innerText = chord.notes;

            // ç¹ªè£½æŒ‡æ³•
            const board = document.getElementById('fretboard');
            document.querySelectorAll('.finger').forEach(f => f.remove());

            chord.fingers.forEach(f => {
                const dot = document.createElement('div');
                dot.className = 'finger';
                // è¨ˆç®—ä½ç½®
                const x = (6 - f.s) * 20; // å¼¦
                const y = (f.f * 20) - 10; // æ ¼ (å–æ ¼ä¸­é–“)
                dot.style.left = x + '%';
                dot.style.top = y + '%';
                board.appendChild(dot);
            });

            // å¦‚æœè²éŸ³é–‹å•Ÿï¼Œè‡ªå‹•æ’­æ”¾
            if (isSoundOn) {
                playChordSound(chord.freq);
            }
        }

        function playChordSound(frequencies) {
            const now = Tone.now();
            frequencies.forEach((f, i) => {
                // æ¨¡æ“¬è¼•å¾®æ’¥å¼¦å»¶é²æ„Ÿ (Strumming)
                synth.triggerAttackRelease(f, "2n", now + i * 0.04);
            });
        }
    </script>
</body>
</html>